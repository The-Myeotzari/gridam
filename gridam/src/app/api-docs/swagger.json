{
  "openapi": "3.0.0",
  "info": {
    "title": "Gridam API",
    "version": "1.0.0",
    "description": "gridam API"
  },
  "servers": [{ "url": "/apis", "description": "Next.js App Router API base (ë¡œì»¬/ë°°í¬ ê³µí†µ)" }],
  "tags": [
    {
      "name": "Auth",
      "description": "íšŒì›ê°€ì…, ë¡œê·¸ì¸, ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë“± ì¸ì¦ ê´€ë ¨ API"
    },
    {
      "name": "Me",
      "description": "ë‚´ ì •ë³´( Supabase Auth User ) API"
    },
    {
      "name": "Storage",
      "description": "ì´ë¯¸ì§€ ì—…ë¡œë“œ"
    },
    {
      "name": "Drafts",
      "description": "ì„ì‹œì €ì¥(Drafts) CRUD ë° ê²Œì‹œ(publish) API. ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ëŠ” **ë¡œê·¸ì¸ ì‚¬ìš©ì ì „ìš©**ì´ë©°, Authorization í—¤ë”ë¡œ Supabase access_token(JWT)ì„ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤."
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Supabase access_token"
      }
    },
    "schemas": {
      "SuccessEnvelope": {
        "type": "object",
        "properties": {
          "ok": { "type": "boolean", "example": true },
          "message": { "type": "string", "example": "ok" },
          "data": {}
        },
        "required": ["ok", "message"]
      },
      "ErrorEnvelope": {
        "type": "object",
        "properties": {
          "ok": { "type": "boolean", "example": false },
          "message": { "type": "string", "example": "VALIDATION_ERROR" },
          "details": { "type": "object", "nullable": true }
        },
        "required": ["ok", "message"]
      },
      "Draft": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "example": "7f9c7a87-bb69-4e35-8baf-1b6b0eac3e50"
          },
          "user_id": { "type": "string", "format": "uuid" },
          "content": { "type": "string", "maxLength": 200 },
          "image_url": { "type": "string", "nullable": true, "example": "images/<uid>/canvas.png" },
          "emoji": { "type": "string", "nullable": true, "example": "ğŸ™‚" },
          "status": { "type": "string", "enum": ["draft", "published"], "example": "draft" },
          "date": { "type": "string", "format": "date", "example": "2025-11-07" },
          "published_at": { "type": "string", "format": "date-time", "nullable": true },
          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" },
          "deleted_at": { "type": "string", "format": "date-time", "nullable": true }
        },
        "required": ["id", "user_id", "content", "status", "date", "created_at"]
      },
      "DraftCreate": {
        "type": "object",
        "required": ["content", "date"],
        "properties": {
          "content": {
            "type": "string",
            "minLength": 1,
            "maxLength": 200,
            "example": "ì˜¤ëŠ˜ì€ í•´ê°€ ì¨ì¨ ğŸŒ"
          },
          "image": {
            "type": "string",
            "nullable": true,
            "description": "storage object path",
            "example": "images/<uid>/canvas.png"
          },
          "emoji": { "type": "string", "nullable": true, "example": "ğŸŒ" },
          "date": {
            "type": "string",
            "format": "date",
            "description": "YYYY-MM-DD",
            "example": "2025-11-07"
          }
        }
      },
      "DraftUpdate": {
        "type": "object",
        "properties": {
          "content": {
            "type": "string",
            "minLength": 1,
            "maxLength": 200,
            "example": "ìˆ˜ì •ë³¸ ë‚´ìš©"
          },
          "image": { "type": "string", "nullable": true, "example": "images/<uid>/new.png" },
          "emoji": { "type": "string", "nullable": true, "example": "âœ¨" }
        },
        "additionalProperties": false
      },
      "PublishResult": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "status": { "type": "string", "enum": ["published"], "example": "published" },
          "published_at": {
            "type": "string",
            "format": "date-time",
            "example": "2025-11-07T09:05:00.000Z"
          },
          "date": { "type": "string", "format": "date", "example": "2025-11-07" }
        },
        "required": ["id", "status", "published_at", "date"]
      }
    }
  },
  "security": [{ "bearerAuth": [] }],
  "paths": {
    "/apis/drafts": {
      "post": {
        "tags": ["Drafts"],
        "summary": "Create a draft diary",
        "description": "ì„ì‹œì €ì¥(ì´ˆì•ˆ) ìƒì„±. `date`ëŠ” **YYYY-MM-DD** ë¬¸ìì—´ì´ì–´ì•¼ í•¨.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/DraftCreate" } }
          }
        },
        "responses": {
          "201": {
            "description": "ì´ˆì•ˆ ìƒì„± ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [{ "$ref": "#/components/schemas/SuccessEnvelope" }],
                  "properties": { "data": { "$ref": "#/components/schemas/Draft" } }
                }
              }
            }
          },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "422": {
            "description": "VALIDATION_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      }
    },
    "/apis/drafts/latest": {
      "get": {
        "tags": ["Drafts"],
        "summary": "Get latest draft",
        "description": "ë³¸ì¸ ê¸°ì¤€ ìµœì‹  ì„ì‹œì €ì¥ 1ê±´ ë°˜í™˜. ì—†ìœ¼ë©´ `data: null`.",
        "responses": {
          "200": {
            "description": "ì¡°íšŒ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [{ "$ref": "#/components/schemas/SuccessEnvelope" }],
                  "properties": {
                    "data": {
                      "oneOf": [{ "$ref": "#/components/schemas/Draft" }, { "type": "null" }]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      }
    },
    "/apis/drafts/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" },
          "description": "Draft ID (uuid)"
        }
      ],
      "get": {
        "tags": ["Drafts"],
        "summary": "Get a single draft (by id)",
        "description": "ë³¸ì¸ ì†Œìœ , `status='draft'`, `deleted_at IS NULL` ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì´ˆì•ˆ 1ê±´ ì¡°íšŒ.",
        "responses": {
          "200": {
            "description": "ì¡°íšŒ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [{ "$ref": "#/components/schemas/SuccessEnvelope" }],
                  "properties": { "data": { "$ref": "#/components/schemas/Draft" } }
                }
              }
            }
          },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "404": {
            "description": "NOT_FOUND (ì¡°ê±´ ë¶ˆì¼ì¹˜)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      },
      "patch": {
        "tags": ["Drafts"],
        "summary": "Update a draft",
        "description": "ì„ì‹œì €ì¥ ì¼ë¶€ ìˆ˜ì •. bodyëŠ” ë¶€ë¶„ í•„ë“œë§Œ í¬í•¨ ê°€ëŠ¥.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/DraftUpdate" } }
          }
        },
        "responses": {
          "200": {
            "description": "ìˆ˜ì • ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [{ "$ref": "#/components/schemas/SuccessEnvelope" }],
                  "properties": { "data": { "$ref": "#/components/schemas/Draft" } }
                }
              }
            }
          },
          "400": {
            "description": "BAD_REQUEST (id í˜•ì‹ ì˜¤ë¥˜ ë“±)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "404": {
            "description": "NOT_FOUND (ì¡°ê±´ ë¶ˆì¼ì¹˜)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "422": {
            "description": "VALIDATION_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      },
      "delete": {
        "tags": ["Drafts"],
        "summary": "Soft delete a draft",
        "description": "`deleted_at` íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ê°±ì‹ í•˜ëŠ” ì†Œí”„íŠ¸ ì‚­ì œ.",
        "responses": {
          "204": { "description": "ì‚­ì œ ì„±ê³µ (ë³¸ë¬¸ ì—†ìŒ)" },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "404": {
            "description": "NOT_FOUND (ì¡°ê±´ ë¶ˆì¼ì¹˜)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      }
    },
    "/apis/drafts/{id}/publish": {
      "post": {
        "tags": ["Drafts"],
        "summary": "Publish a draft",
        "description": "ì´ˆì•ˆì„ ê²Œì‹œ ìƒíƒœ(`published`)ë¡œ ì „í™˜. í•˜ë£¨ 1ê²Œì‹œ ì œí•œ(ê°™ì€ user_id+date published ìœ ë‹ˆí¬)ì— ê±¸ë¦¬ë©´ 409.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "format": "uuid" }
          }
        ],
        "responses": {
          "200": {
            "description": "ê²Œì‹œ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [{ "$ref": "#/components/schemas/SuccessEnvelope" }],
                  "properties": { "data": { "$ref": "#/components/schemas/PublishResult" } }
                }
              }
            }
          },
          "401": {
            "description": "UNAUTHORIZED",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "403": {
            "description": "FORBIDDEN (RLS)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "404": {
            "description": "NOT_FOUND (draft ì—†ìŒ)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "409": {
            "description": "DAILY_LIMIT (ìœ ë‹ˆí¬ ì¶©ëŒ)",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          },
          "500": {
            "description": "INTERNAL_ERROR",
            "content": {
              "application/json": { "schema": { "$ref": "#/components/schemas/ErrorEnvelope" } }
            }
          }
        }
      }
    },
    "/apis/auth/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ íšŒì›ê°€ì… (ì¸ì¦ ë©”ì¼ ë°œì†¡)",
        "description": "íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ ì¸ì¦ ë§í¬ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì´ì–´ë„ ê°™ì€ ì•ˆë‚´ ë¬¸êµ¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. (Supabase ë³´ì•ˆ ì„¤ì • ì¡°ì • ë¶ˆê°€)",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "example": "jane.doe@example.com"
                  },
                  "password": { "type": "string", "minLength": 8, "example": "R!chPassw0rd" },
                  "nickname": { "type": "string", "example": "jane" }
                },
                "required": ["email", "password", "nickname"]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "íšŒì›ê°€ì… ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "user": {
                      "type": "object",
                      "example": {
                        "id": "fcc2asfasfd-6301-45ba-a8cc-0asf502a93",
                        "aud": "authenticated",
                        "role": "authenticated",
                        "email": "asd123@gmail.com",
                        "phone": "",
                        "confirmation_sent_at": "2025-11-08T08:47:30.794880492Z",
                        "app_metadata": { "provider": "email", "providers": ["email"] },
                        "user_metadata": {
                          "email": "asd123@gmail.com",
                          "email_verified": false,
                          "nickname": "asdasd",
                          "phone_verified": false,
                          "sub": "fasfasfd-6301-45asfcc-0asfasf93"
                        },
                        "identities": {
                          "identity_id": "14asfasfe9-8fasf-4cae-8asf-a36004",
                          "id": "fcc27asfasf6301-45ba-a8cc-09dc21502asf",
                          "user_id": "fccasfasfd-6301-45ba-a8cc-09dasfa93",
                          "identity_data": {
                            "email": "asd123@gmail.com",
                            "email_verified": false,
                            "nickname": "asdasd",
                            "phone_verified": false,
                            "sub": "fccasfasf-6301asfba-a8ccasf502a93"
                          },

                          "provider": "email",
                          "last_sign_in_at": "2025-11-08T08:47:30.76319728Z",
                          "created_at": "2025-11-08T08:47:30.763966Z",
                          "updated_at": "2025-11-08T08:47:30.763966Z",
                          "email": "asd123@gmail.com"
                        },
                        "created_at": "2025-11-08T08:47:30.738882Z",
                        "updated_at": "2025-11-08T08:47:31.822949Z",
                        "is_anonymous": false
                      }
                    },
                    "message": {
                      "type": "string",
                      "example": "ì´ë©”ì¼ ì¸ì¦ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "400": { "description": "ìœ íš¨ì„± ì˜¤ë¥˜" },
          "409": { "description": "ì¤‘ë³µ ì´ë©”ì¼" }
        }
      }
    },
    "/apis/auth/confirm": {
      "get": {
        "tags": ["Auth"],
        "summary": "ì´ë©”ì¼ ì¸ì¦ í™•ì¸ & ë¦¬ë‹¤ì´ë ‰íŠ¸",
        "description": "Supabaseê°€ ì „ì†¡í•œ ì¸ì¦ ë©”ì¼ì˜ ë§í¬ë¥¼ í†µí•´ ì ‘ê·¼í•˜ëŠ” í™•ì¸ í˜ì´ì§€ì…ë‹ˆë‹¤.",
        "parameters": {
          "in": "query",
          "name": "next",
          "required": "false",
          "schema": {
            "type": "string",
            "example": "/welcome"
          },
          "description": "ì¸ì¦ ì™„ë£Œ í›„ ì´ë™í•  ê²½ë¡œ. ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ í™ˆ(/)ë¡œ ì´ë™í•©ë‹ˆë‹¤."
        },
        "responses": {
          "200": {
            "description": "í™•ì¸ í˜ì´ì§€ì— ë„ì°©(í´ë¼ì´ì–¸íŠ¸ê°€ í•´ì‹œ ì²˜ë¦¬ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ ìˆ˜í–‰)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": "true"
                    },
                    "message": {
                      "type": "string",
                      "example": "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê³§ ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "ì˜ëª»ëœ ì ‘ê·¼(í•„ìˆ˜ ì •ë³´ ëˆ„ë½ ë“±)",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "ok": {
                    "type": "boolean",
                    "example": "false"
                  },
                  "message": {
                    "type": "string",
                    "example": "ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤. ì¸ì¦ ë§í¬ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸",
        "description": "ì„±ê³µ ì‹œ Supabase ì„¸ì…˜ ì¿ í‚¤ê°€ ì„¤ì •ë©ë‹ˆë‹¤.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "example": "jane.doe@example.com"
                  },
                  "password": {
                    "type": "string",
                    "example": "R!chPassw0rd"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ë¡œê·¸ì¸ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": "true"
                    },
                    "user": {
                      "type": "object",
                      "example": {
                        "id": "fcc2asfasfd-6301-45ba-a8cc-0asf502a93",
                        "aud": "authenticated",
                        "role": "authenticated",
                        "email": "asd123@gmail.com",
                        "phone": "",
                        "confirmation_sent_at": "2025-11-08T08:47:30.794880492Z",
                        "app_metadata": { "provider": "email", "providers": ["email"] },
                        "user_metadata": {
                          "email": "asd123@gmail.com",
                          "email_verified": false,
                          "nickname": "asdasd",
                          "phone_verified": false,
                          "sub": "fasfasfd-6301-45asfcc-0asfasf93"
                        },
                        "identities": {
                          "identity_id": "14asfasfe9-8fasf-4cae-8asf-a36004",
                          "id": "fcc27asfasf6301-45ba-a8cc-09dc21502asf",
                          "user_id": "fccasfasfd-6301-45ba-a8cc-09dasfa93",
                          "identity_data": {
                            "email": "asd123@gmail.com",
                            "email_verified": false,
                            "nickname": "asdasd",
                            "phone_verified": false,
                            "sub": "fccasfasf-6301asfba-a8ccasf502a93"
                          },

                          "provider": "email",
                          "last_sign_in_at": "2025-11-08T08:47:30.76319728Z",
                          "created_at": "2025-11-08T08:47:30.763966Z",
                          "updated_at": "2025-11-08T08:47:30.763966Z",
                          "email": "asd123@gmail.com"
                        },

                        "created_at": "2025-11-08T08:47:30.738882Z",
                        "updated_at": "2025-11-08T08:47:31.822949Z",
                        "is_anonymous": false
                      },
                      "session": {
                        "type": "object",
                        "properties": {
                          "access_token": {
                            "type": "string",
                            "example": "eyJhbGciOiJIUzI1NiIsInR5..."
                          },
                          "refresh_token": {
                            "type": "string",
                            "example": "v0Odt6eyqX8..."
                          },
                          "expires_in": {
                            "type": "integer",
                            "example": 3600
                          }
                        }
                      },
                      "message": {
                        "type": "string",
                        "example": "ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤."
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "ì¸ì¦ ì‹¤íŒ¨",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/auth/logout": {
      "post": {
        "tags": ["Auth"],
        "summary": "ë¡œê·¸ì•„ì›ƒ",
        "description": "Supabase ì„¸ì…˜ì„ ë¬´íš¨í™”í•©ë‹ˆë‹¤.",
        "responses": {
          "200": {
            "description": "ë¡œê·¸ì•„ì›ƒ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "ì„¸ì…˜ ì—†ìŒ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¡œê·¸ì¸ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/auth/reset/complete": {
      "post": {
        "tags": ["Auth"],
        "summary": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì™„ë£Œ (ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì €ì¥)",
        "description": "ì‚¬ìš©ìê°€ ë©”ì¼ë¡œ ì „ë‹¬ë°›ì€ ë§í¬ë¥¼ í†µí•´ ì§„ì…í•œ ë’¤ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.\në§í¬ì˜ í† í°ì„ Supabaseê°€ ìë™ ê²€ì¦í•œ í›„ ì„¸ì…˜ì´ í™œì„±í™”ëœ ìƒíƒœì—ì„œ ìš”ì²­í•´ì•¼ í•©ë‹ˆë‹¤.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "newPassword": {
                    "type": "string",
                    "example": "N3wR!chPassw0rd"
                  }
                },
                "required": ["newPassword"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "user": {
                      "type": "object",
                      "example": {
                        "id": "fcc2asfasfd-6301-45ba-a8cc-0asf502a93",
                        "aud": "authenticated",
                        "role": "authenticated",
                        "email": "asd123@gmail.com",
                        "phone": "",
                        "confirmation_sent_at": "2025-11-08T08:47:30.794880492Z",
                        "app_metadata": {
                          "provider": "email",
                          "providers": ["email"]
                        },
                        "user_metadata": {
                          "email": "asd123@gmail.com",
                          "email_verified": false,
                          "nickname": "asdasd",
                          "phone_verified": false,
                          "sub": "fasfasfd-6301-45asfcc-0asfasf93"
                        },
                        "identities": [
                          {
                            "identity_id": "14asfasfe9-8fasf-4cae-8asf-a36004",
                            "id": "fcc27asfasf6301-45ba-a8cc-09dc21502asf",
                            "user_id": "fccasfasfd-6301-45ba-a8cc-09dasfa93",
                            "identity_data": {
                              "email": "asd123@gmail.com",
                              "email_verified": false,
                              "nickname": "asdasd",
                              "phone_verified": false,
                              "sub": "fccasfasf-6301asfba-a8ccasf502a93"
                            },
                            "provider": "email",
                            "last_sign_in_at": "2025-11-08T08:47:30.76319728Z",
                            "created_at": "2025-11-08T08:47:30.763966Z",
                            "updated_at": "2025-11-08T08:47:30.763966Z",
                            "email": "asd123@gmail.com"
                          }
                        ],
                        "created_at": "2025-11-08T08:47:30.738882Z",
                        "updated_at": "2025-11-08T08:47:31.822949Z",
                        "is_anonymous": false
                      }
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "í† í°/ì„¸ì…˜ ì—†ìŒ ë˜ëŠ” ë§Œë£Œë¨",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì„ ìš”ì²­í•´ ì£¼ì„¸ìš”."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ë¹„ë°€ë²ˆí˜¸ ì •ì±… ìœ„ë°˜ ë“± ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, ëŒ€ë¬¸ìì™€ íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "ì„œë²„ ì˜¤ë¥˜",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/auth/reset/request": {
      "post": {
        "tags": ["Auth"],
        "summary": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì¼ ë°œì†¡",
        "description": "ì¡´ì¬ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë™ì¼í•œ ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤.\nì‚¬ìš©ìëŠ” ë°›ì€ ë©”ì¼ì˜ ë§í¬ë¥¼ í†µí•´ ë‹¤ìŒ ë‹¨ê³„(complete)ë¡œ ì´ë™í•©ë‹ˆë‹¤.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "example": "jane.doe@example.com"
                  }
                },
                "required": ["email"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ì•ˆë‚´ ë¬¸êµ¬ (í•­ìƒ ë™ì¼)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "ì„œë²„ ì˜¤ë¥˜",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ë©”ì¼ ë°œì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/me": {
      "get": {
        "tags": ["Me"],
        "summary": "ë‚´ ì •ë³´( Supabase Auth User ) + ì¼ê¸° í†µê³„ + ìµœì‹  3ê°œ",
        "responses": {
          "200": {
            "description": "ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user": {
                          "type": "object",
                          "description": "Supabase Auth User",
                          "properties": {
                            "id": {
                              "type": "string",
                              "example": "fcc2-...-a93"
                            },
                            "email": {
                              "type": "string",
                              "example": "user@example.com"
                            },
                            "app_metadata": {
                              "type": "object",
                              "properties": {
                                "provider": {
                                  "type": "string",
                                  "example": "email"
                                },
                                "providers": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  },
                                  "example": ["email"]
                                }
                              }
                            },
                            "user_metadata": {
                              "type": "object",
                              "additionalProperties": true
                            }
                          }
                        },
                        "stats": {
                          "type": "object",
                          "properties": {
                            "diariesCount": {
                              "type": "integer",
                              "example": 42
                            },
                            "postDaysCount": {
                              "type": "integer",
                              "example": 17
                            }
                          }
                        },
                        "latestDiaries": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": { "type": "string" },
                              "image_url": { "type": "string", "nullable": true },
                              "emoji": { "type": "string" },
                              "content": { "type": "string", "nullable": true },
                              "created_at": { "type": "string" },
                              "updated_at": { "type": "string", "nullable": true }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "ì¸ì¦ í•„ìš”",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "ì„œë²„ ì˜¤ë¥˜",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": {
                      "type": "boolean",
                      "example": false
                    },
                    "message": {
                      "type": "string",
                      "example": "ì˜¤ë¥˜ ë°œìƒ"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/apis/uploads": {
      "post": {
        "tags": ["Storage"],
        "summary": "ì—…ë¡œë“œ(í”„ë¼ì´ë¹— ë²„í‚·) + ì¦‰ì‹œ ì„œëª… URL ë°˜í™˜",
        "description": "- RLS: own-folder ì •ì±…(`path_tokens[1] = auth.uid()`)ì„ í†µê³¼í•´ì•¼ í•¨\n- ìš”ì²­ ì£¼ì²´ëŠ” **ì¸ì¦ ì‚¬ìš©ì**ì—¬ì•¼ í•˜ë©°, ë¼ìš°íŠ¸ëŠ” **ì‚¬ìš©ì ì„¸ì…˜ ì»¨í…ìŠ¤íŠ¸**ë¡œ ë™ì‘í•´ì•¼ í•¨\n- ì„±ê³µ ì‹œ `path`ì™€ TTLì´ ì§§ì€ `signedUrl`ì„ ë°˜í™˜",
        "security": [{ "cookieAuth": [] }, { "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "PNG/JPEG/WebP ì´ë¯¸ì§€ íŒŒì¼"
                  }
                },
                "required": ["file"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ì—…ë¡œë“œ ì„±ê³µ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": true },
                    "message": {
                      "type": "string",
                      "example": "ì´ë¯¸ì§€ ì—…ë¡œë“œì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."
                    },
                    "path": {
                      "type": "string",
                      "example": "8b5c0f1e-8f4a-4a36-9e9b-1b2a3c4d5e6f/1731123456789.png"
                    },
                    "signedUrl": {
                      "type": "string",
                      "example": "https://*.supabase.co/storage/v1/object/sign/diary-images/8b5c.../1731.png?token=..."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "ì˜ëª»ëœ ìš”ì²­(íŒŒì¼ ëˆ„ë½ ë“±)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "file í•„ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "ì¸ì¦ í•„ìš”(ì„¸ì…˜/í† í° ì—†ìŒ)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "RLS ìœ„ë°˜(own-folder ë¶ˆì¼ì¹˜ ë“±)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "new row violates row-level security policy"
                    }
                  }
                }
              }
            }
          },
          "415": {
            "description": "í—ˆìš©ë˜ì§€ ì•Šì€ MIME íƒ€ì…",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "í—ˆìš©ë˜ì§€ ì•Šì€ MIME: image/gif"
                    }
                  }
                }
              }
            }
          },
          "413": {
            "description": "íŒŒì¼ ìš©ëŸ‰ ì´ˆê³¼",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "íŒŒì¼ì´ ë„ˆë¬´ í½ë‹ˆë‹¤(ìµœëŒ€ 5MB)"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "ì„œë²„ ì—ëŸ¬",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ok": { "type": "boolean", "example": false },
                    "message": {
                      "type": "string",
                      "example": "ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤."
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
